<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html lang="en"><head>
    <title>Problem - 99999553 - Codeforces</title>
    <!--CombineResourcesFilter-->
    <!-- MathJax -->
    <!-- /MathJax -->
    <!--/CombineResourcesFilter-->
    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->
</head>
<body class=" "><span style="display:none;" class="csrf-token" data-csrf="0cc86f07f5398eb1445779bdc0124fff"> </span>
<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>
<!-- Codeforces JavaScripts. -->
<div id="body">
<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br/>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>
<div id="header" style="position: relative;">
    <div style="float:left;">
            <a href="/"><img style="height: 50px; margin-top: 10px;" title="Make Codeforces, not Coronaforces" alt="Make Codeforces not Coronaforces" src="//sta.codeforces.com/s/19522/images/codeforces-vs-coronavirus-65.png"/></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="?locale=en"><img src="//sta.codeforces.com/s/19522/images/flags/24/gb.png" title="In English" alt="In English"/></a>
            <a href="?locale=ru"><img src="//sta.codeforces.com/s/19522/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
        </div>
        <div>
                        <a href="/enter?back=%2Fproblemsets%2Facmsguru%2Fproblem%2F99999%2F553">Enter</a>
                     | 
                        <a href="/register">Register</a>
        </div>
    </div>
    <br style="clear: both;"/>
</div>
    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
            <div class="roundbox-lb"> </div>
            <div class="roundbox-rb"> </div>
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class="current"><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="0cc86f07f5398eb1445779bdc0124fff"/>
            <input class="search" name="query" data-isplaceholder="true" value=""/>
        </form>
    <br style="clear: both;"/>
</div>
    </div>
            <br style="height: 3em; clear: both;"/>
        <div style="position: relative;">
                        <div id="sidebar">
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"><a style="color: black" href="/contest/99999">acmsguru</a></th>
                </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class="contest-state-phase">Finished</span></td>
                    </tr>
            </tbody>
        </table>
    </div>
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
        <div class="caption titled">→ Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        No tags yet
    <div style="clear:both;text-align:right;font-size:1.1rem;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>
<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;"><input type="hidden" name="csrf_token" value="0cc86f07f5398eb1445779bdc0124fff"/>
    <input name="action" type="hidden" value="addTag"/>
    <input name="problemId" type="hidden" value="177639"/>
    <input name="tagName" type="hidden" value=""/>
</form>
<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;"><input type="hidden" name="csrf_token" value="0cc86f07f5398eb1445779bdc0124fff"/>
    <input name="action" type="hidden" value="removeTag"/>
    <input name="problemId" type="hidden" value="177639"/>
    <input name="tagName" type="hidden" value=""/>
</form>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list">
        <li class="current selectedLava"><a href="/problemsets/acmsguru">Problems</a></li>
        <li><a href="/problemsets/acmsguru/submit">Submit</a></li>
        <li><a href="/problemsets/acmsguru/status">Status</a></li>
        <li><a href="/problemsets/acmsguru/standings">Standings</a></li>
        <li><a href="/problemsets/acmsguru/customtest">Custom test</a></li>
</ul>
</div>
    <div class="diff-popup">
    </div>
<div class="problemindexholder" problemindex="553" data-uuid="ps_c06a396c2467b6639034cce951891656a4c584de">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">×</span>
    </div>
        <div class="ttypography"><div style="line-height: 1.3em;"><div align="center"><h4>553. Sultan&#39;s Pearls</h4></div><div align="center">Time limit per test: 1   second(s)<br/>Memory limit: 262144   kilobytes</div><div align="center">input: standard<br/>output: standard</div><br/><br/><br/>Sultan Suleiman was so rich that legends spread far and wide about his treasures. This problem is going to be about one of those legends. <br/><br/>One of the sultan&#39;s favorite treasures was a string of finest pearls that he kept on the bedside table. He never touched the string as it had too many pearls on it to wear. The sultan&#39;s cunning servant decided to take advantage of this fact and &#34;borrow&#34; a few pearls. The string consisted of <i>n</i> pearls, <i>m</i> of them hung down from the bedside table. In this problem we will consider the pearls indexed by integers from 1 to <i>n</i>, starting from the end that lies on the table, that is, pearls 1, 2,..., <i>n</i>-<i>m</i> were located on the table and pearls <i>n</i>-<i>m</i>+1, <i>n</i>-<i>m</i>+2,..., <i>n</i> hung down from it.<br/><br/><center> <img src="https://espresso.codeforces.com/cf7ab00ff23157823025ef7bad885cd845ab341c.png" style="max-width: 100.0%;max-height: 100.0%;"/><br/> Sample for <i>n</i>=10 and <i>m</i>=3. </center><br/><br/>The servant decided to take exactly one pearl from one end of the string every day. But he had to be perfectly careful as every evening the sultan enjoyed looking at the string and counting the number of the hanging pearls. That&#39;s why after the servant took a pearl from the hanging end, he had to pull the string one pearl lower so that the number of the hanging pearls equalled <i>m</i> again. Certainly, if the servant took a pearl from the lying end, he had to leave the hanging part as it was.<br/><br/>Each pearl has some mass, and the string may fall down if the hanging part is too heavy. Of course, the servant must avoid that. The string must remain motionless after every action of the servant.<br/><br/>More formally, assume that the <i>i</i>-th pearl in the string has mass of <i>w</i><sub><i>i</i></sub>. Also let&#39;s say that the total mass of the hanging <i>m</i> pearls equals <i>W</i><sub><i>h</i></sub>, and the total mass of the pearls on the table equals <i>W</i><sub><i>t</i></sub>. Then the hanging part pulls the whole string down, if <i>W</i><sub><i>h</i></sub> &gt; <i>k</i> · <i>W</i><sub><i>t</i></sub>, where <i>k</i> is the coefficient of friction of the pearls against the table. The coefficient <i>k</i> is the same for all pearls.<br/><br/>The pearls on the string had not only different masses but also different prices: the <i>i</i>-th pearl costs <i>c</i><sub><i>i</i></sub> dinars. The servant&#39;s aim was to steal the pearls for the maximum sum and avoid the sultan&#39;s suspicions. His plan didn&#39;t come out very well: he made a mistake somewhere in his calculations, his theft was discovered and he was executed.<br/><br/>Nobody is going to execute you, of course, so we suggest you to solve the problem that proved to be too hard for the sultan&#39;s servant.<br/><br/><div align="left" style="margin-top: 1.0em;"><b>Input</b></div>The first line contains three integers <i>n</i>, <i>m</i> and <i>k</i> (2 ≤ <i>n</i> ≤ 2 · 10<sup>5</sup>, 1 ≤ <i>m</i> &lt; <i>n</i>, 1 ≤ <i>k</i> ≤ 10). Each of the following <i>n</i> lines contains two integers <i>w</i><sub><i>i</i></sub> and <i>c</i><sub><i>i</i></sub> — the mass and the price of the <i>i</i>-th pearl (1 ≤ <i>w</i><sub><i>i</i></sub>, <i>c</i><sub><i>i</i></sub> ≤ 1000). It is guaranteed that initially the string is motionless, that is, the hanging part doesn&#39;t pull the whole string down.<br/><br/><div align="left" style="margin-top: 1.0em;"><b>Output</b></div>In the first line print two space-separated integers <i>p</i> and <i>s</i> — the number of pearls you can take to get the maximum sum of money, and the sum you can get. In the second line print the string consisting of <i>p</i> characters &#39;<pre style="display: inline;font-size: 120.0%;">H</pre>&#39; or &#39;<pre style="display: inline;font-size: 120.0%;">T</pre>&#39;. If the pearl that is the <i>i</i>-th to take should be taken from the hanging end, then the <i>i</i>-th character of the string must be &#39;<pre style="display: inline;font-size: 120.0%;">H</pre>&#39;, otherwise — &#39;<pre style="display: inline;font-size: 120.0%;">T</pre>&#39;. If there are multiple optimal solutions, print any of them.<br/><br/>If the servant can&#39;t take any pearl, just print one line containing two zeroes. You may leave the second line empty or do not print it at all.<br/><br/><div align="left" style="margin-top: 1.0em;"><b>Example(s)</b></div> <table cellpadding="4" cellspacing="0" style="border-collapse: collapse;border: 1.0px black solid;">  <tbody><tr>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>sample input</pre>  </td>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>sample output</pre>  </td>  </tr>  <tr>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>5 2 1
5 3
4 2
6 4
3 2
2 2
</pre>  </td>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>2 5
TT
</pre>  </td>  </tr> </tbody></table><br/> <table cellpadding="4" cellspacing="0" style="border-collapse: collapse;border: 1.0px black solid;">  <tbody><tr>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>sample input</pre>  </td>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>sample output</pre>  </td>  </tr>  <tr>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>20 7 2
3 4
8 4
8 5
6 14
5 10
3 18
2 5
2 4
1 6
3 11
4 3
3 5
2 8
4 6
9 14
7 2
7 6
6 4
8 2
10 5
</pre>  </td>  <td style="border-collapse: collapse;border: 1.0px black solid;" valign="top" width="400">  <pre>11 60
HTHTHTHHHHH
</pre>  </td>  </tr> </tbody></table><br/> <br/><br/><div align="left" style="margin-top: 1.0em;"><b>Note</b></div>There is the explanation to the second sample.<br/><br/>Initially the mass of pearls on the table was <i>W</i><sub><i>t</i></sub> = 50, and the mass of the hanging pearls was <i>W</i><sub><i>h</i></sub> = 51. However, as the coefficient of friction equals 2, the string is motionless (50 · 2 = 100 &gt; 51).<br/><br/>On the first step we take a pearl from the hanging part of the string (<i>H</i>), then we need to pull the string one pearl lower so that the hanging part contained 7 strings again. After that <i>W</i><sub><i>t</i></sub> = 48, and <i>W</i><sub><i>h</i></sub> = 43 (the pearl number 20 with value 5 will be stolen and the pearl number 13 will be the topmost pearl in the hanging part of the string).<br/><br/>On the second step we take a pearl from the end of the string that lies on the table (<i>T</i>). <i>W</i><sub><i>h</i></sub> = 43 still, <i>W</i><sub><i>t</i></sub> = 45, (45 · 2 &gt; 43), the total price of the stolen treasure is <i>S</i> = 9.<br/><br/>The table describes the values of <i>W</i><sub><i>t</i></sub>, <i>W</i><sub><i>h</i></sub> and <i>S</i> after each step.<br/><br/><br/><br/><br/><br/><table border="1"> <tbody><tr><td>Step</td> <td>End</td> <td><i>W</i><sub><i>t</i></sub></td> <td><i>W</i><sub><i>h</i></sub></td> <td><i>S</i></td></tr><tr><td>1</td><td>H</td><td>48</td><td>43</td><td>5</td></tr> <tr><td>2</td><td>T</td><td>45</td><td>43</td><td>9</td></tr> <tr><td>3</td><td>H</td><td> 42 </td><td>38</td><td>11</td></tr> <tr><td>4</td><td>T</td><td> 34 </td><td>38</td><td>15</td></tr> <tr><td>5</td><td>H</td><td> 30 </td><td>36</td><td>19</td></tr> <tr><td>6</td><td>T</td><td> 22 </td><td>36</td><td>24</td></tr> <tr><td>7</td><td>H</td><td> 19 </td><td>32</td><td>30</td></tr> <tr><td>8</td><td>H</td><td> 18 </td><td>26</td><td>32</td></tr> <tr><td>9</td><td>H</td><td> 16 </td><td>19</td><td>46</td></tr> <tr><td>10</td><td>H</td><td>14 </td><td>17</td><td>52</td></tr> <tr><td>11</td><td>H</td><td>11 </td><td>18</td><td>60</td></tr></tbody></table><br/><br/>Note that after the 11-th step it is impossible to take any more pearls without disrupting the balance.<br/><br/> </div><hr/></div>
</div>
                </div>
        </div>
            <br style="clear: both;"/>
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2020 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: <span class="format-timewithseconds" data-locale="en">Dec/09/2020 20:41:37</span> (g1).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller"><a href="/privacy">Privacy Policy</a></div>
                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div style="margin-top: 8px; padding-bottom: 20px; position: relative; left: 10px;">
                        <a href="https://telegram.org/"><img style="margin-right: 2em; width: 60px;" src="//sta.codeforces.com/s/19522/images/telegram-100x100.png" alt="Telegram" title="Telegram"/></a>
                        <a href="http://ifmo.ru/en/"><img style="width: 120px;" src="//sta.codeforces.com/s/19522/images/itmo_small_en-logo.png" alt="ИТМО" title="ИТМО"/></a>
                    </div>
            </div>
        <div class="userListsFacebox" style="display:none;">
            <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt"> </div>
            <div class="rt"> </div>
            <div class="lb"> </div>
            <div class="rb"> </div>
            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists
                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>
                    <img class="closed" src="//sta.codeforces.com/s/19522/images/icons/control.png"/>
                    <span class="filter" style="display:none;">
                        <img class="opened" src="//sta.codeforces.com/s/19522/images/icons/control-270.png"/>
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;"/>
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt"> </div>
            <div class="irt"> </div>
            <table class="">
                    <thead>
                    <tr>
                        <th>Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
            </table>
            </div>
        </div>
            </div>
        </div>
</div>
</body></html>